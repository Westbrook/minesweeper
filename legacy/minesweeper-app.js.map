{"version":3,"file":"minesweeper-app.js","sources":["../../src/minesweeper-menu.js","../../src/minesweeper-app.js"],"sourcesContent":["import { LitElement, html, css } from 'lit-element';\n\nconst difficultyLevels = Array.apply(null, {length: 10}).map(Number.call, Number);\n\nclass MinesweeperMenu extends LitElement {\n  static get properties() {\n    return {\n      difficulty: { type: Number },\n    };\n  }\n\n  constructor() {\n    super();\n    this.difficulty = 1;\n  }\n\n  _newGame() {\n    this.dispatchEvent(\n      new CustomEvent('minesweeper-new-game', {\n        bubbles: true,\n        composed: true,\n        detail: {\n          difficulty: this.difficulty,\n        },\n      }),\n    );\n  }\n\n  _changeDifficulty(e) {\n    this.difficulty = e.target.value;\n    this._newGame();\n  }\n\n  static get styles() {\n    return [\n      css`\n        :host {\n          display: flex;\n          align-items: center;\n          flex-shrink: 0;\n          height: 48px;\n        }\n      `,\n    ];\n  }\n\n  render() {\n    return html`\n      <button @click=${this._newGame}>New Game</button>\n      <label>\n        Difficulty\n        <select @change=${this._changeDifficulty}>\n          <option disabled>Select Difficulty</option>\n          ${difficultyLevels.map(\n            (level) => html`\n              <option\n                value=${level + 1}\n                ?selected=${this.difficulty === level + 1}\n              >${level + 1}</option>\n            `,\n          )}\n        </select>\n      </label>\n    `;\n  }\n}\n\ncustomElements.define('minesweeper-menu', MinesweeperMenu);\n","import { LitElement, html, css } from 'lit-element';\n\nimport './minesweeper-menu.js';\n\nexport const defaultBoard = [];\n\nclass MinesweeperApp extends LitElement {\n  static get properties() {\n    return {\n      width: { type: Number },\n      height: { type: Number },\n      across: { type: Number },\n      down: { type: Number },\n      board: { type: Array },\n      mines: {\n        type: Number,\n        hasChanged() {\n          return false;\n        },\n      },\n      difficulty: { type: Number },\n      squareSize: { type: Number },\n    };\n  }\n\n  constructor() {\n    super();\n    this.width = 0;\n    this.height = 0;\n    this.board = defaultBoard;\n    this.mines = 0;\n    this.difficulty = 5;\n    this.squareSize = 50;\n  }\n\n  measure() {\n    this.width = this.offsetWidth;\n    this.height = this.offsetHeight;\n    this.startNewGame();\n  }\n\n  startNewGame(e = { detail: { difficulty: false } }) {\n    this.difficulty = e.detail.difficulty || this.difficulty;\n    this.createBoard();\n  }\n\n  createBoard() {\n    let across = this.across = Math.floor(this.width / this.squareSize);\n    let down = this.down = Math.floor(this.height / this.squareSize);\n    const downCount = down;\n    const board = Array(across);\n    this.mines = 0;\n    while (across) {\n      across -= 1;\n      board[across] = Array(down);\n      down = downCount;\n      while (down) {\n        down -= 1;\n        board[across][down] = this._setSquare();\n      }\n    }\n    this.board = board;\n  }\n\n  _setSquare() {\n    const isMine = Math.round(Math.random() * 100) <= this.difficulty * 4;\n    if (isMine) this.mines += 1;\n    const square = {\n      state: isMine ? 'MINE' : 'NOT_MINE'\n    };\n    return square;\n  }\n\n  _gameOver() {\n    requestIdleCallback(() => this._requestNewGame());\n  }\n\n  _requestNewGame() {\n    if (window.confirm('Game Over.\\n\\n\\nStart a new game?')) {\n      this.startNewGame();\n    }\n  }\n\n  static get styles() {\n    return [\n      css`\n        :host {\n          display: flex;\n          flex-direction: column;\n          flex-grow: 1;\n          height: 100vh;\n\n          --minesweeper-square-size: 50px;\n        }\n        .dark-theme {\n          --color-square-background: black;\n          --color-square-focus: neongreen;\n          --color-square-border: lightblue;\n          --color-danger-low: green;\n          --color-danger-medium: yellow;\n          --color-danger-high: orange;\n          --color-danger-worry: red;\n          --color-dead: white;\n        }\n      `,\n    ];\n  }\n\n  render() {\n    return html`\n      <minesweeper-menu\n        difficulty=\"${this.difficulty}\"\n        @minesweeper-new-game=${this.startNewGame}\n      ></minesweeper-menu>\n      <minesweeper-board\n        style=${`--columns:${this.across};--rows:${this.down};`}\n        .board=${this.board}\n        .mines=${this.mines}\n        @minesweeper-game-over=${this._gameOver}\n      ></minesweeper-board>\n    `;\n  }\n\n  firstUpdated() {\n    import('./minesweeper-board.js').then(() => this.measure());\n  }\n}\n\ncustomElements.define('minesweeper-app', MinesweeperApp);\n"],"names":["difficultyLevels","Array","apply","length","map","Number","call","MinesweeperMenu","difficulty","LitElement","type","dispatchEvent","CustomEvent","bubbles","composed","detail","this","e","target","value","_newGame","html","_changeDifficulty","level","_this2","css","customElements","define","defaultBoard","MinesweeperApp","width","height","board","mines","squareSize","across","down","hasChanged","offsetWidth","offsetHeight","startNewGame","createBoard","Math","floor","downCount","_setSquare","isMine","round","random","state","requestIdleCallback","_requestNewGame","window","confirm","_gameOver","then","_this3","measure"],"mappings":"gnBAEA,IAAMA,EAAmBC,MAAMC,MAAM,KAAM,CAACC,OAAQ,KAAKC,IAAIC,OAAOC,KAAMD,QAEpEE,8EASGC,WAAa,eATQC,oDAEnB,CACLD,WAAY,CAAEE,KAAML,wDAUjBM,cACH,IAAIC,YAAY,uBAAwB,CACtCC,SAAS,EACTC,UAAU,EACVC,OAAQ,CACNP,WAAYQ,KAAKR,yDAMPS,QACXT,WAAaS,EAAEC,OAAOC,WACtBC,8DAiBEC,MACYL,KAAKI,SAGFJ,KAAKM,kBAEnBtB,EAAiBI,IACjB,SAACmB,UAAUF,MAECE,EAAQ,EACJC,EAAKhB,aAAee,EAAQ,EACvCA,EAAQ,6CAxBd,CACLE,goBAgCNC,eAAeC,OAAO,mBAAoBpB,OC/D7BqB,mBAAe,IAEtBC,8EAqBGC,MAAQ,IACRC,OAAS,IACTC,MAAQJ,IACRK,MAAQ,IACRzB,WAAa,IACb0B,WAAa,gBA1BOzB,oDAElB,CACLqB,MAAO,CAAEpB,KAAML,QACf0B,OAAQ,CAAErB,KAAML,QAChB8B,OAAQ,CAAEzB,KAAML,QAChB+B,KAAM,CAAE1B,KAAML,QACd2B,MAAO,CAAEtB,KAAMT,OACfgC,MAAO,CACLvB,KAAML,OACNgC,6BACS,IAGX7B,WAAY,CAAEE,KAAML,QACpB6B,WAAY,CAAExB,KAAML,uDAejByB,MAAQd,KAAKsB,iBACbP,OAASf,KAAKuB,kBACdC,0DAGMvB,yDAAI,CAAEF,OAAQ,CAAEP,YAAY,SAClCA,WAAaS,EAAEF,OAAOP,YAAcQ,KAAKR,gBACzCiC,wDAIDN,EAASnB,KAAKmB,OAASO,KAAKC,MAAM3B,KAAKc,MAAQd,KAAKkB,YACpDE,EAAOpB,KAAKoB,KAAOM,KAAKC,MAAM3B,KAAKe,OAASf,KAAKkB,YAC/CU,EAAYR,EACZJ,EAAQ/B,MAAMkC,YACfF,MAAQ,EACNE,OAELH,EADAG,GAAU,GACMlC,MAAMmC,GACtBA,EAAOQ,EACAR,GACLA,GAAQ,EACRJ,EAAMG,GAAQC,GAAQpB,KAAK6B,kBAG1Bb,MAAQA,2CAIPc,EAASJ,KAAKK,MAAsB,IAAhBL,KAAKM,WAAqC,EAAlBhC,KAAKR,kBACnDsC,IAAQ9B,KAAKiB,OAAS,GACX,CACbgB,MAAOH,EAAS,OAAS,2DAM3BI,oBAAoB,kBAAM1B,EAAK2B,8DAI3BC,OAAOC,QAAQ,2CACZb,uDA8BAnB,MAEWL,KAAKR,WACKQ,KAAKwB,iCAGRxB,KAAKmB,0BAAiBnB,KAAKoB,UACvCpB,KAAKgB,MACLhB,KAAKiB,MACWjB,KAAKsC,sEAM3B,mCAA0BC,KAAK,kBAAMC,EAAKC,mDAxC1C,CACLhC,iBA2CNC,eAAeC,OAAO,kBAAmBE"}