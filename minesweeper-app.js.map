{"version":3,"file":"minesweeper-app.js","sources":["../src/minesweeper-menu.js","../src/minesweeper-app.js"],"sourcesContent":["import { LitElement, html, css } from 'lit-element';\n\nconst difficultyLevels = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];\n\nclass MinesweeperMenu extends LitElement {\n  static get properties() {\n    return {\n      difficulty: { type: Number },\n    };\n  }\n\n  constructor() {\n    super();\n    this.difficulty = 1;\n  }\n\n  _newGame() {\n    this.dispatchEvent(\n      new CustomEvent('minesweeper-new-game', {\n        bubbles: true,\n        composed: true,\n        detail: {\n          difficulty: this.difficulty,\n        },\n      }),\n    );\n  }\n\n  _changeDifficulty(e) {\n    this.difficulty = e.target.value;\n    this._newGame();\n  }\n\n  static get styles() {\n    const withoutStyleTag = css`\n      :host(:nth-last-child(1)) {\n        height: 100%;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n      }\n      :host(:nth-last-child(1)) > * {\n        padding: 10px;\n      }\n    `;\n    const withStyleTag = css`\n      :host(:nth-last-child(2)) {\n        height: 100%;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n      }\n      :host(:nth-last-child(2)) > * {\n        padding: 10px;\n      }\n    `;\n    return [\n      css`\n        :host {\n          display: flex;\n          align-items: center;\n          flex-shrink: 0;\n          height: 48px;\n        }\n      `,\n      !('attachShadow' in Element.prototype) || document.adoptedStyleSheets ? withoutStyleTag : withStyleTag,\n    ];\n  }\n\n  render() {\n    return html`\n      <button @click=${this._newGame}>New Game</button>\n      <label>\n        Difficulty\n        <select @change=${this._changeDifficulty}>\n          <option disabled>Select Difficulty</option>\n          ${difficultyLevels.map(\n            level => html`\n              <option value=${level + 1} ?selected=${this.difficulty === level + 1}\n                >${level + 1}</option\n              >\n            `,\n          )}\n        </select>\n      </label>\n    `;\n  }\n}\n\ncustomElements.define('minesweeper-menu', MinesweeperMenu);\n","import { LitElement, html, css } from 'lit-element';\n\nimport { defaultBoard } from './constants.js';\nimport './minesweeper-menu.js';\n\nclass MinesweeperApp extends LitElement {\n  static get properties() {\n    return {\n      width: { type: Number },\n      height: { type: Number },\n      across: { type: Number },\n      down: { type: Number },\n      board: { type: Array },\n      mines: {\n        type: Number,\n        hasChanged() {\n          return false;\n        },\n      },\n      difficulty: { type: Number },\n      squareSize: { type: Number },\n    };\n  }\n\n  constructor() {\n    super();\n    this.width = 0;\n    this.height = 0;\n    this.board = defaultBoard;\n    this.mines = 0;\n    this.difficulty = 5;\n    this.squareSize = 50;\n  }\n\n  measure() {\n    import('./minesweeper-board.js');\n    this.width = this.offsetWidth;\n    this.height = this.offsetHeight;\n    this.startNewGame();\n  }\n\n  startNewGame(e = { detail: { difficulty: false } }) {\n    this.difficulty = e.detail.difficulty || this.difficulty;\n    this.createBoard();\n  }\n\n  createBoard() {\n    let across = Math.floor(this.width / this.squareSize);\n    this.across = across;\n    let down = Math.floor(this.height / this.squareSize);\n    this.down = down;\n    const downCount = down;\n    const board = Array(across);\n    this.mines = 0;\n    while (across) {\n      across -= 1;\n      board[across] = Array(down);\n      down = downCount;\n      while (down) {\n        down -= 1;\n        board[across][down] = this._setSquare();\n      }\n    }\n    this.board = board;\n  }\n\n  _setSquare() {\n    const isMine = Math.round(Math.random() * 100) <= this.difficulty * 4;\n    if (isMine) this.mines += 1;\n    const square = {\n      state: isMine ? 'MINE' : 'NOT_MINE',\n    };\n    return square;\n  }\n\n  _gameOver() {\n    requestIdleCallback(() => this._requestNewGame());\n  }\n\n  _requestNewGame() {\n    if (window.confirm('Game Over.\\n\\n\\nStart a new game?')) {\n      this.startNewGame();\n    }\n  }\n\n  static get styles() {\n    return [\n      css`\n        :host {\n          display: flex;\n          flex-direction: column;\n          flex-grow: 1;\n          height: 100vh;\n\n          --minesweeper-square-size: 50px;\n        }\n        .dark-theme {\n          --color-square-background: black;\n          --color-square-focus: neongreen;\n          --color-square-border: lightblue;\n          --color-danger-low: green;\n          --color-danger-medium: yellow;\n          --color-danger-high: orange;\n          --color-danger-worry: red;\n          --color-dead: white;\n        }\n      `,\n    ];\n  }\n\n  render() {\n    return html`\n      <minesweeper-menu\n        difficulty=\"${this.difficulty}\"\n        @minesweeper-new-game=${this.measure}\n      ></minesweeper-menu>\n      ${this.across && this.down\n        ? html`\n            <minesweeper-board\n              style=${`--columns:${this.across};--rows:${this.down};`}\n              .board=${this.board}\n              .mines=${this.mines}\n              @minesweeper-game-over=${this._gameOver}\n            ></minesweeper-board>\n          `\n        : html``}\n    `;\n  }\n}\n\ncustomElements.define('minesweeper-app', MinesweeperApp);\n"],"names":["difficultyLevels","customElements","define","LitElement","difficulty","type","Number","constructor","_newGame","dispatchEvent","CustomEvent","bubbles","composed","detail","this","_changeDifficulty","e","target","value","withoutStyleTag","css","withStyleTag","Element","prototype","document","adoptedStyleSheets","render","html","map","level","width","height","across","down","board","Array","mines","hasChanged","squareSize","defaultBoard","measure","offsetWidth","offsetHeight","startNewGame","createBoard","Math","floor","downCount","_setSquare","isMine","round","random","state","_gameOver","requestIdleCallback","_requestNewGame","window","confirm"],"mappings":"w5BAEMA,EAAmB,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,mvBAuFrDC,eAAeC,OAAO,mBArFtB,cAA8BC,gCAEnB,CACLC,WAAY,CAAEC,KAAMC,SAIxBC,2BAEOH,WAAa,EAGpBI,gBACOC,cACH,IAAIC,YAAY,uBAAwB,CACtCC,SAAS,EACTC,UAAU,EACVC,OAAQ,CACNT,WAAYU,KAAKV,eAMzBW,kBAAkBC,QACXZ,WAAaY,EAAEC,OAAOC,WACtBV,qCAICW,EAAkBC,OAWlBC,EAAeD,aAWd,CACLA,OAQE,iBAAkBE,QAAQC,YAAcC,SAASC,mBAAuCJ,EAAlBF,GAI5EO,gBACSC,MACYb,KAAKN,SAGFM,KAAKC,kBAEnBf,EAAiB4B,IACjBC,GAASF,MACSE,EAAQ,EAAef,KAAKV,aAAeyB,EAAQ,EAC9DA,EAAQ,QCmD3B5B,eAAeC,OAAO,kBA7HtB,cAA6BC,gCAElB,CACL2B,MAAO,CAAEzB,KAAMC,QACfyB,OAAQ,CAAE1B,KAAMC,QAChB0B,OAAQ,CAAE3B,KAAMC,QAChB2B,KAAM,CAAE5B,KAAMC,QACd4B,MAAO,CAAE7B,KAAM8B,OACfC,MAAO,CACL/B,KAAMC,OACN+B,WAAU,KACD,GAGXjC,WAAY,CAAEC,KAAMC,QACpBgC,WAAY,CAAEjC,KAAMC,SAIxBC,2BAEOuB,MAAQ,OACRC,OAAS,OACTG,MAAQK,OACRH,MAAQ,OACRhC,WAAa,OACbkC,WAAa,GAGpBE,uBACS,wCACFV,MAAQhB,KAAK2B,iBACbV,OAASjB,KAAK4B,kBACdC,eAGPA,mBAAa3B,yDAAI,CAAEH,OAAQ,CAAET,YAAY,SAClCA,WAAaY,EAAEH,OAAOT,YAAcU,KAAKV,gBACzCwC,cAGPA,kBACMZ,EAASa,KAAKC,MAAMhC,KAAKgB,MAAQhB,KAAKwB,iBACrCN,OAASA,MACVC,EAAOY,KAAKC,MAAMhC,KAAKiB,OAASjB,KAAKwB,iBACpCL,KAAOA,QACNc,EAAYd,EACZC,EAAQC,MAAMH,YACfI,MAAQ,EACNJ,OAELE,EADAF,GAAU,GACMG,MAAMF,GACtBA,EAAOc,EACAd,GACLA,GAAQ,EACRC,EAAMF,GAAQC,GAAQnB,KAAKkC,kBAG1Bd,MAAQA,EAGfc,mBACQC,EAASJ,KAAKK,MAAsB,IAAhBL,KAAKM,WAAqC,EAAlBrC,KAAKV,kBACnD6C,IAAQnC,KAAKsB,OAAS,GACX,CACbgB,MAAOH,EAAS,OAAS,YAK7BI,YACEC,oBAAoB,IAAMxC,KAAKyC,mBAGjCA,kBACMC,OAAOC,QAAQ,2CACZd,yCAKA,CACLvB,QAuBJM,gBACSC,MAEWb,KAAKV,WACKU,KAAK0B,QAE7B1B,KAAKkB,QAAUlB,KAAKmB,KAClBN,0BAEyBb,KAAKkB,0BAAiBlB,KAAKmB,UACvCnB,KAAKoB,MACLpB,KAAKsB,MACWtB,KAAKuC,WAGlC1B"}